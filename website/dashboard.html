<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - ASIN Scout Pro</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{--bg:#0a0a0f;--bg2:#12121a;--bg3:#1a1a25;--text:#f0f0f5;--text2:#9898a8;--text3:#5a5a6e;--orange:#ff6b2c;--green:#22c97a;--blue:#4d8eff;--red:#ff4d5e;--border:#2a2a35}
        body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text)}
        .sidebar{position:fixed;left:0;top:0;bottom:0;width:250px;background:var(--bg2);border-right:1px solid var(--border);padding:20px;display:flex;flex-direction:column}
        .sidebar-logo{display:flex;align-items:center;gap:10px;font-size:18px;font-weight:800;margin-bottom:40px;text-decoration:none;color:var(--text)}
        .sidebar-logo span{color:var(--orange)}
        .sidebar-logo .icon{width:36px;height:36px;background:linear-gradient(135deg,#ff2c6b,var(--orange));border-radius:10px;display:flex;align-items:center;justify-content:center}
        .sidebar-menu{list-style:none;flex:1}
        .sidebar-menu a{display:block;padding:12px 16px;color:var(--text2);text-decoration:none;border-radius:10px;margin-bottom:4px;font-size:14px}
        .sidebar-menu a:hover,.sidebar-menu a.active{background:var(--bg3);color:var(--text)}
        .sidebar-menu a.active{color:var(--orange)}
        .sidebar-user{border-top:1px solid var(--border);padding-top:20px;display:flex;align-items:center;gap:12px}
        .sidebar-user .avatar{width:36px;height:36px;min-width:36px;min-height:36px;flex-shrink:0;background:var(--orange);border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:600;font-size:14px}
        .sidebar-user .name{font-size:13px;font-weight:600}
        .sidebar-user .email{font-size:11px;color:var(--text3)}
        .lang-switch{display:flex;gap:6px;margin-top:15px;padding-top:15px;border-top:1px solid var(--border)}
        .lang-btn{flex:1;background:transparent;border:1px solid var(--border);color:var(--text2);padding:8px;border-radius:6px;cursor:pointer;font-size:12px}
        .lang-btn:hover,.lang-btn.active{border-color:var(--orange);color:var(--orange)}
        .main{margin-left:250px;padding:30px}
        .page-title{font-size:28px;font-weight:700;margin-bottom:30px}
        .package-box{background:linear-gradient(135deg,rgba(255,107,44,0.1),rgba(255,44,107,0.1));border:1px solid rgba(255,107,44,0.3);border-radius:16px;padding:24px;margin-bottom:24px}
        .package-box.none{background:rgba(255,77,94,0.1);border-color:rgba(255,77,94,0.3)}
        .package-box h3{font-size:20px;margin-bottom:8px}
        .package-box .limit{font-size:14px;color:var(--text2)}
        .package-box .limit strong{color:var(--green);font-size:18px}
        .package-box .expires{font-size:12px;color:var(--text3);margin-top:8px}
        .stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-bottom:30px}
        .stat-card{background:var(--bg2);border:1px solid var(--border);border-radius:16px;padding:24px}
        .stat-card .label{font-size:13px;color:var(--text2);margin-bottom:8px}
        .stat-card .value{font-size:32px;font-weight:800}
        .stat-card .value.orange{color:var(--orange)}
        .stat-card .value.blue{color:var(--blue)}
        .card{background:var(--bg2);border:1px solid var(--border);border-radius:16px;padding:24px}
        .card-title{font-size:18px;font-weight:600;margin-bottom:20px;display:flex;justify-content:space-between;align-items:center}
        table{width:100%;border-collapse:collapse}
        th,td{text-align:left;padding:14px;border-bottom:1px solid var(--border);font-size:14px}
        th{color:var(--text2);font-size:12px;text-transform:uppercase}
        .badge{padding:4px 10px;border-radius:20px;font-size:11px;font-weight:600}
        .badge.green{background:rgba(34,201,122,0.15);color:var(--green)}
        .btn{padding:8px 16px;border:none;border-radius:8px;font-size:13px;font-weight:600;cursor:pointer;text-decoration:none}
        .btn-outline{background:transparent;border:1px solid var(--border);color:var(--text)}
        .btn-sm{padding:6px 12px;font-size:12px}
        .btn-copy{background:rgba(77,142,255,0.15);border:1px solid rgba(77,142,255,0.3);color:var(--blue);margin-right:6px}
        .btn-copy:hover{background:rgba(77,142,255,0.25)}
        .btn-copy.copied{background:var(--green);border-color:var(--green);color:#fff}
        .empty{text-align:center;padding:60px 20px;color:var(--text2)}
        .empty-icon{font-size:48px;margin-bottom:16px;opacity:0.5}
        .empty-title{font-size:18px;color:var(--text);margin-bottom:8px}
        .packages-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px;margin-bottom:24px}
        .user-package{background:linear-gradient(135deg,rgba(255,107,44,0.1),rgba(255,44,107,0.1));border:1px solid rgba(255,107,44,0.3);border-radius:16px;padding:20px;position:relative}
        .user-package.expiring-soon{border-color:rgba(255,193,7,0.5);background:linear-gradient(135deg,rgba(255,193,7,0.1),rgba(255,107,44,0.1))}
        .user-package h4{font-size:18px;margin-bottom:12px;display:flex;justify-content:space-between;align-items:center}
        .user-package .pkg-badge{font-size:11px;background:var(--orange);color:#fff;padding:3px 8px;border-radius:12px}
        .user-package .pkg-info{display:flex;flex-direction:column;gap:8px;font-size:13px;color:var(--text2)}
        .user-package .pkg-info strong{color:var(--text);font-size:15px}
        .user-package .pkg-row{display:flex;justify-content:space-between;align-items:center}
        .user-package .daily-bar{height:6px;background:var(--bg3);border-radius:3px;overflow:hidden;margin-top:4px}
        .user-package .daily-bar-fill{height:100%;background:var(--green);border-radius:3px;transition:width 0.3s}
        .user-package .daily-bar-fill.warning{background:var(--orange)}
        .user-package .daily-bar-fill.danger{background:var(--red)}
        .user-package .expires-text{font-size:11px;color:var(--text3);margin-top:8px}
        .no-packages{background:rgba(255,77,94,0.1);border:1px solid rgba(255,77,94,0.3);border-radius:16px;padding:24px;text-align:center;margin-bottom:24px}
        .no-packages h3{color:var(--red);margin-bottom:8px}
        .mobile-toggle{display:none;position:fixed;top:12px;left:12px;z-index:1001;background:var(--bg2,#12121a);border:1px solid var(--border,#2a2a35);border-radius:8px;padding:8px 12px;color:var(--text,#f0f0f5);font-size:18px;cursor:pointer}
        .sidebar-overlay{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.6);z-index:999}
        @media(max-width:768px){.mobile-toggle{display:block}.sidebar{transform:translateX(-100%);transition:transform 0.3s;z-index:1000}.sidebar.open{transform:translateX(0)}.main{margin-left:0}.sidebar-overlay.active{display:block}}
    </style>
</head>
<body>
<button class="mobile-toggle" onclick="document.querySelector('.sidebar').classList.toggle('open');document.querySelector('.sidebar-overlay').classList.toggle('active')">&#9776;</button>
<div class="sidebar-overlay" onclick="document.querySelector('.sidebar').classList.remove('open');this.classList.remove('active')"></div>
    <aside class="sidebar">
        <a href="index.html" class="sidebar-logo"><div class="icon">A</div>ASIN<span>Scout</span></a>
        <ul class="sidebar-menu">
            <a href="dashboard.html" class="active" data-i18n="sidebar_dashboard">ğŸ“Š Dashboard</a>
            <a href="scans.html" data-i18n="sidebar_scans">ğŸ“ My Scans</a>
            <a href="affiliate.html" id="affiliateLink" style="display:none">ğŸ¤ Affiliate</a>
            <a href="pricing.html" data-i18n="sidebar_buy">ğŸ’³ Buy Package</a>
            <a href="settings.html" data-i18n="sidebar_settings">âš™ï¸ Settings</a>
            <a href="#" onclick="logout()" data-i18n="sidebar_logout">ğŸšª Logout</a>
        </ul>
        <div class="sidebar-user">
            <div class="avatar" id="userAvatar">U</div>
            <div><div class="name" id="userName">User</div><div class="email" id="userEmail"></div></div>
        </div>
        <div class="lang-switch">
            <button class="lang-btn" data-lang="en" onclick="setLanguage('en')">EN</button>
            <button class="lang-btn" data-lang="tr" onclick="setLanguage('tr')">TR</button>
        </div>
    </aside>
    <main class="main">
        <h1 class="page-title" data-i18n="dash_title">Dashboard</h1>
        <!-- Ã‡oklu Paket Listesi -->
        <div id="userPackagesContainer"></div>

        <!-- Eski sistem iÃ§in fallback -->
        <div class="package-box" id="packageBox" style="display:none;">
            <h3 id="packageName">-</h3>
            <div class="limit"><span data-i18n="dash_scan_limit">Scan Limit</span>: <strong id="scanLimit">0</strong></div>
            <div class="expires" id="packageExpires"></div>
        </div>
        <div class="stats-grid">
            <div class="stat-card"><div class="label" data-i18n="dash_total_scans">Total Scans</div><div class="value orange" id="totalScans">0</div></div>
            <div class="stat-card"><div class="label" data-i18n="dash_total_asins">Total ASINs</div><div class="value blue" id="totalAsins">0</div></div>
        </div>

        <!-- Extension Download & User Guide -->
        <div class="card" style="margin-bottom:24px">
            <div class="card-title"><span>ğŸ§©</span> <span data-i18n="dash_extension">Chrome Extension</span></div>
            <div style="display:flex;gap:12px;flex-wrap:wrap;margin-bottom:20px">
                <a href="#" id="downloadExtBtn" class="btn btn-primary" style="display:inline-flex;align-items:center;gap:8px;padding:12px 24px;background:linear-gradient(135deg,var(--orange),#ff2c6b);text-decoration:none">
                    <span style="font-size:20px">â¬‡ï¸</span> <span data-i18n="dash_download_ext">Download Extension</span>
                </a>
                <a href="#" id="chromeStoreBtn" class="btn btn-outline" style="display:none;align-items:center;gap:8px;padding:12px 24px;text-decoration:none">
                    <span style="font-size:20px">ğŸŒ</span> <span data-i18n="dash_chrome_store">Chrome Web Store</span>
                </a>
            </div>
            <div id="userGuideContent" style="background:var(--bg);border:1px solid var(--border);border-radius:12px;padding:20px;line-height:1.8;font-size:14px;color:var(--text2)">
                <div style="text-align:center;padding:20px;color:var(--text3)">
                    <span style="font-size:24px">ğŸ“–</span><br>
                    <span data-i18n="dash_guide_loading">Loading guide...</span>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-title"><span data-i18n="dash_recent_scans">Recent Scans</span><a href="scans.html" class="btn btn-outline btn-sm" data-i18n="dash_view_all">View All</a></div>
            <div id="recentScans"><div class="empty"><div class="empty-icon">ğŸ“</div><div class="empty-title" data-i18n="dash_no_scans">No scans yet</div></div></div>
        </div>
    </main>
    <script src="assets/js/i18n.js"></script>
    <script src="assets/js/auth.js"></script>
    <script>
        const API='/api';
        const token=AuthHelper.getToken();
        if(!token)location.href='login.html';
        const user=AuthHelper.getUser()||{};
        // Token yenileme baÅŸlat
        AuthHelper.startTokenRefresh();
        document.getElementById('userName').textContent=user.name||'User';
        document.getElementById('userEmail').textContent=user.email||'';
        document.getElementById('userAvatar').textContent=(user.name||'U')[0].toUpperCase();
        
        async function load(){
            // Load settings (extension URLs, user guide)
            try{
                const sr=await fetch(API+'/settings.php?action=public');
                const sd=await sr.json();
                if(sd.success && sd.data){
                    const settings=sd.data;
                    // Extension download URL
                    const extBtn=document.getElementById('downloadExtBtn');
                    if(settings.extension_url){
                        extBtn.href=settings.extension_url;
                    }else{
                        extBtn.style.display='none';
                    }
                    // Chrome Web Store URL
                    const chromeBtn=document.getElementById('chromeStoreBtn');
                    if(settings.chrome_store_url){
                        chromeBtn.href=settings.chrome_store_url;
                        chromeBtn.style.display='inline-flex';
                    }
                    // User Guide (language-based)
                    const lang=localStorage.getItem('asin_lang')||'tr';
                    const guideKey=lang==='tr'?'user_guide_tr':'user_guide_en';
                    const guide=settings[guideKey]||settings.user_guide_tr||'';
                    const guideEl=document.getElementById('userGuideContent');
                    if(guide){
                        guideEl.innerHTML=guide;
                    }else{
                        // Default guide
                        guideEl.innerHTML=getDefaultGuide(lang);
                    }
                }
            }catch(e){console.error('Settings load error:', e);}

            try{
                const r=await fetch(API+'/auth.php?action=profile',{headers:{'Authorization':'Bearer '+token}});
                const d=await r.json();
                if(d.success){
                    const u=d.data.user,s=d.data.stats;
                    document.getElementById('totalScans').textContent=s.total_scans||0;
                    document.getElementById('totalAsins').textContent=fmt(s.total_asins||0);
                    // Affiliate menÃ¼sÃ¼nÃ¼ gÃ¶ster
                    if(u.is_affiliate){document.getElementById('affiliateLink').style.display='block';}
                }
            }catch(e){}

            // Ã‡oklu paket sistemini yÃ¼kle
            try{
                const pr=await fetch(API+'/packages.php?action=my_packages',{headers:{'Authorization':'Bearer '+token}});
                const pd=await pr.json();
                const container=document.getElementById('userPackagesContainer');

                if(pd.success && pd.data.user_packages && pd.data.user_packages.length > 0){
                    let html='<div class="packages-grid">';
                    for(const pkg of pd.data.user_packages){
                        const isExpiringSoon = pkg.days_remaining <= 3;
                        const dailyUsed = pkg.daily_scans_used || 0;
                        const dailyLimit = pkg.daily_scan_limit || 0;
                        const dailyRemaining = pkg.daily_remaining;
                        const usagePercent = dailyLimit > 0 ? Math.round((dailyUsed / dailyLimit) * 100) : 0;
                        let barClass = '';
                        if(usagePercent >= 80) barClass = 'danger';
                        else if(usagePercent >= 50) barClass = 'warning';

                        html += `<div class="user-package ${isExpiringSoon ? 'expiring-soon' : ''}">
                            <h4>${esc(pkg.package_name)} <span class="pkg-badge">Aktif</span></h4>
                            <div class="pkg-info">
                                <div class="pkg-row">
                                    <span>Tarama baÅŸÄ±na max ASIN:</span>
                                    <strong>${fmtNum(pkg.scan_limit)}</strong>
                                </div>
                                <div class="pkg-row">
                                    <span>GÃ¼nlÃ¼k tarama hakkÄ±:</span>
                                    <strong>${dailyLimit > 0 ? (dailyRemaining + ' / ' + dailyLimit + ' kaldÄ±') : 'SÄ±nÄ±rsÄ±z'}</strong>
                                </div>
                                ${dailyLimit > 0 ? `<div class="daily-bar"><div class="daily-bar-fill ${barClass}" style="width:${usagePercent}%"></div></div>` : ''}
                                <div class="expires-text">${isExpiringSoon ? 'âš ï¸ ' : ''}SÃ¼re: ${pkg.days_remaining} gÃ¼n kaldÄ± (${new Date(pkg.expires_at).toLocaleDateString()})</div>
                            </div>
                        </div>`;
                    }
                    html += '</div>';
                    container.innerHTML = html;
                } else {
                    // Eski sisteme fallback veya paket yok
                    try{
                        const r=await fetch(API+'/auth.php?action=profile',{headers:{'Authorization':'Bearer '+token}});
                        const d=await r.json();
                        if(d.success){
                            const u=d.data.user;
                            if(u.package_name && u.scan_limit > 0){
                                document.getElementById('packageBox').style.display='block';
                                document.getElementById('packageName').textContent=u.package_name+' Package';
                                document.getElementById('scanLimit').textContent=fmt(u.scan_limit);
                                document.getElementById('packageExpires').textContent=t('dash_expires')+': '+new Date(u.package_expires).toLocaleDateString();
                            }else{
                                container.innerHTML=`<div class="no-packages">
                                    <h3>${t('dash_no_package')}</h3>
                                    <p><a href="pricing.html" style="color:var(--orange)">${t('dash_buy_package')}</a></p>
                                </div>`;
                            }
                        }
                    }catch(e){
                        container.innerHTML=`<div class="no-packages">
                            <h3>${t('dash_no_package')}</h3>
                            <p><a href="pricing.html" style="color:var(--orange)">${t('dash_buy_package')}</a></p>
                        </div>`;
                    }
                }
            }catch(e){
                console.error('Package load error:', e);
            }
            try{
                const sr=await fetch(API+'/scans.php?action=list&limit=5',{headers:{'Authorization':'Bearer '+token}});
                const sd=await sr.json();
                if(sd.success&&sd.data.scans&&sd.data.scans.length>0){
                    let h='<table><thead><tr><th>'+t('dash_store')+'</th><th>'+t('dash_asins')+'</th><th>'+t('dash_status')+'</th><th>'+t('dash_date')+'</th><th></th></tr></thead><tbody>';
                    for(const sc of sd.data.scans){
                        h+=`<tr><td>${esc(sc.store_name)}</td><td><strong>${fmt(sc.asin_count)}</strong></td><td><span class="badge green">${sc.status}</span></td><td>${new Date(sc.created_at).toLocaleDateString()}</td><td><button class="btn btn-copy btn-sm" onclick="copyAsins(${sc.id},this)" title="Kopyala">ğŸ“‹</button><a href="scan-detail.html?id=${sc.id}" class="btn btn-outline btn-sm">${t('dash_view')}</a></td></tr>`;
                    }
                    document.getElementById('recentScans').innerHTML=h+'</tbody></table>';
                }
            }catch(e){}
        }
        function logout(){AuthHelper.logout();}
        function fmt(n){return n>=1000?Math.round(n/1000)+'K':String(n||0);}
        function getDefaultGuide(lang){
            if(lang==='tr'){
                return `<h3 style="color:var(--orange);margin-bottom:16px">ğŸ“– ASIN Scout Pro KullanÄ±m KÄ±lavuzu</h3>
<h4 style="margin:16px 0 8px;color:var(--text)">ğŸ”§ Eklenti Kurulumu</h4>
<ol style="margin-left:20px;margin-bottom:16px">
<li>YukarÄ±daki <strong>"Eklentiyi Ä°ndir"</strong> butonuna tÄ±klayÄ±n</li>
<li>Ä°ndirilen ZIP dosyasÄ±nÄ± bilgisayarÄ±nÄ±zda bir klasÃ¶re Ã§Ä±kartÄ±n</li>
<li>Chrome tarayÄ±cÄ±nÄ±zda <strong>chrome://extensions</strong> adresine gidin</li>
<li>SaÄŸ Ã¼st kÃ¶ÅŸeden <strong>"GeliÅŸtirici modu"</strong>nu aÃ§Ä±n</li>
<li><strong>"PaketlenmemiÅŸ Ã¶ÄŸe yÃ¼kle"</strong> butonuna tÄ±klayÄ±n</li>
<li>ZIP'ten Ã§Ä±karttÄ±ÄŸÄ±nÄ±z klasÃ¶rÃ¼ seÃ§in - Kurulum tamamlandÄ±!</li>
</ol>

<h4 style="margin:16px 0 8px;color:var(--text)">ğŸš€ Tarama NasÄ±l YapÄ±lÄ±r?</h4>
<ol style="margin-left:20px;margin-bottom:16px">
<li>Amazon'da bir satÄ±cÄ± maÄŸazasÄ±na gidin (Ã¶rn: amazon.com/s?me=SELLERID)</li>
<li>TarayÄ±cÄ±nÄ±zÄ±n saÄŸ Ã¼stÃ¼ndeki <strong>ASIN Scout Pro</strong> eklenti ikonuna tÄ±klayÄ±n</li>
<li><strong>"TaramayÄ± BaÅŸlat"</strong> butonuna tÄ±klayÄ±n</li>
<li>Tarama otomatik olarak tÃ¼m sayfalarÄ± gezer ve ASIN'leri toplar</li>
<li>Tarama bittiÄŸinde sonuÃ§larÄ± TXT, Excel olarak indirebilir veya kopyalayabilirsiniz</li>
</ol>

<h4 style="margin:16px 0 8px;color:var(--text)">ğŸ’¡ Ä°puÃ§larÄ±</h4>
<ul style="margin-left:20px;margin-bottom:16px">
<li>Tarama sÄ±rasÄ±nda sayfayÄ± kapatmayÄ±n veya baÅŸka sekmeye geÃ§meyin</li>
<li>BÃ¼yÃ¼k maÄŸazalarda tarama birkaÃ§ dakika sÃ¼rebilir</li>
<li>GÃ¼nlÃ¼k tarama limitinizi "TaramalarÄ±m" sayfasÄ±ndan takip edebilirsiniz</li>
<li>TÃ¼m Amazon pazaryerleri desteklenir (US, UK, DE, FR, IT, ES, JP, CA, AU...)</li>
</ul>

<h4 style="margin:16px 0 8px;color:var(--text)">â“ Sorun mu YaÅŸÄ±yorsunuz?</h4>
<p>Herhangi bir sorunla karÅŸÄ±laÅŸÄ±rsanÄ±z <a href="contact.html" style="color:var(--orange)">Ä°letiÅŸim</a> sayfasÄ±ndan bize ulaÅŸabilirsiniz.</p>`;
            }else{
                return `<h3 style="color:var(--orange);margin-bottom:16px">ğŸ“– ASIN Scout Pro User Guide</h3>
<h4 style="margin:16px 0 8px;color:var(--text)">ğŸ”§ Extension Installation</h4>
<ol style="margin-left:20px;margin-bottom:16px">
<li>Click the <strong>"Download Extension"</strong> button above</li>
<li>Extract the downloaded ZIP file to a folder on your computer</li>
<li>In Chrome browser, go to <strong>chrome://extensions</strong></li>
<li>Enable <strong>"Developer mode"</strong> in the top right corner</li>
<li>Click <strong>"Load unpacked"</strong> button</li>
<li>Select the folder you extracted from the ZIP - Installation complete!</li>
</ol>

<h4 style="margin:16px 0 8px;color:var(--text)">ğŸš€ How to Scan?</h4>
<ol style="margin-left:20px;margin-bottom:16px">
<li>Go to an Amazon seller store (e.g., amazon.com/s?me=SELLERID)</li>
<li>Click the <strong>ASIN Scout Pro</strong> extension icon in the top right of your browser</li>
<li>Click <strong>"Start Scan"</strong> button</li>
<li>The scan will automatically browse all pages and collect ASINs</li>
<li>When done, you can download results as TXT, Excel, or copy them</li>
</ol>

<h4 style="margin:16px 0 8px;color:var(--text)">ğŸ’¡ Tips</h4>
<ul style="margin-left:20px;margin-bottom:16px">
<li>Don't close the page or switch to another tab during scanning</li>
<li>Large stores may take a few minutes to scan</li>
<li>Track your daily scan limit from the "My Scans" page</li>
<li>All Amazon marketplaces are supported (US, UK, DE, FR, IT, ES, JP, CA, AU...)</li>
</ul>

<h4 style="margin:16px 0 8px;color:var(--text)">â“ Having Issues?</h4>
<p>If you encounter any problems, contact us through the <a href="contact.html" style="color:var(--orange)">Contact</a> page.</p>`;
            }
        }
        function fmtNum(n){return Number(n||0).toLocaleString();}
        function esc(s){return String(s||'').replace(/</g,'&lt;');}
        async function copyAsins(scanId,btn){
            btn.textContent='...';
            try{
                const r=await fetch(API+'/scans.php?action=asins&id='+scanId,{headers:{'Authorization':'Bearer '+token}});
                const d=await r.json();
                if(d.success&&d.data.asins){
                    await navigator.clipboard.writeText(d.data.asins.join('\\n'));
                    btn.textContent='âœ“';
                    btn.classList.add('copied');
                    setTimeout(()=>{btn.textContent='ğŸ“‹';btn.classList.remove('copied');},2000);
                }else{
                    btn.textContent='!';
                    setTimeout(()=>{btn.textContent='ğŸ“‹';},2000);
                }
            }catch(e){btn.textContent='!';setTimeout(()=>{btn.textContent='ğŸ“‹';},2000);}
        }
        // Re-render on language change
        window.addEventListener('languageChanged',()=>{load();});
        load();
    </script>
</body>
</html>
